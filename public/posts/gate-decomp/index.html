<!doctype html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/js/all.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sugina-dev/latin-modern-web@1.0.1/style/latinmodern-mono.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<title>quantum gate decomposition | Gigabug</title>
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.23/dist/full.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.tailwindcss.com?plugins=typography,aspect-ratio,line-clamp,container-queries"></script>
<script>
    tailwind.config = {
      daisyui: {
        themes: ["dim", "garden"]
      },
      darkMode: "selector"
    }
  </script>

      <script src="/js/main.js"></script>


</head>
<body class="bg-base-200 text-base-content">
  <header class="w-full">
    <div class="flex flex-col items-center pt-4 space-y-1">
    <a href="/">
        <img class="w-28 rounded-full" src="/headshot.png">
    </a>
    
  <nav>
    <ul class="flex justify-center space-x-3">
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/posts/">Posts</a>
    </li>
    </ul>
  </nav>

    <label class="swap swap-rotate">
        
        <input type="checkbox" class="theme-controller" value="light" />
        
        <svg
          class="swap-off h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" />
        </svg>
        
        <svg
          class="swap-on h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" />
        </svg>
      </label>
</div>

  </header>
  <main class="container min-h-screen px-8 mx-auto">
    <article class="prose dark:prose-invert max-w-prose mx-auto md:prose-lg">
      
<article class="prose dark:prose-invert">
    
    
    <h1>quantum gate decomposition</h1>
    <time datetime="2024-09-12T00:15:22-04:00">September 12, 2024</time>
    <p>This is my attempt to decompose an arbitrary N-qubit unitary using the minimum number of CX gates. It&rsquo;s been my puzzle since I wrote <a href="https://www.mathworks.com/help/matlab/ref/unitarygate.html">unitaryGate</a>, which implements the best known method that uses twice the lower bound. This work explores my thoughts on improving the algorithm. To my knowledge there is no general algorithm for arbitrary matrices using the minimum number of CX gates.</p>
<p>Quantum circuits are executed using the primitive operations of the quantum computer. The matrices of this primitive set form a basis of the unitary group $U(2^N)$. Any 1 qubit rotation, a unitary matrix in U(2), can be decomposed into 3 rotations like Euler rotations. The figure below shows the smallest circuit for any 2-qubit unitary in the basis {CX,RY,RZ}. The circuit uses 3 2-qubit CX gates and 15 1-qubit rotation gates.</p>
<p><img src="/circuit.png" alt="abc"></p>
<p>The Quantum Shannon Decomposition (QSD) is the best known general method, using about twice the lower bound. It uses SVD and EIG to recursively factor out single qubit rotations at each step. The 1- and 2-qubit unitary matrices at the leaf nodes are handled using the algorithms above.</p>
<p><img src="/qsd.png" alt="abc"></p>
<p>The focus will be on the uniform controlled rotation (UCR) gates indicated by $R_Z$ and $R_Y$. The <a href="https://www.mathworks.com/help/matlab/ref/unitarygate.html">unitaryGate</a> function can remove 1-qubit rotation gates with small angles to allow CX gates to cancel. This gives an informal depth-accuracy tradeoff, and motivates my idea towards a minimum CX gate count and approximate error bound. I&rsquo;d like to bound the error on an approximate decomposition based on the user provided angle threshold, hoping that leads to an exact decomposition with some insight how to make the angles sparse. Two papers to help solidify this idea:</p>
<ol>
<li>
<p><a href="https://arxiv.org/pdf/2106.05649">This</a> compresses QSD down to the lower bound using iterative group Lasso regression. Forcing rotation angles to 0 is intuitive but the optimization is expensive. This research is formalized mainly in the language of Lie theory as a recursive sequence of Cartan decompositions. They consider different templates for hardware topology.</p>
</li>
<li>
<p><a href="https://arxiv.org/abs/2205.00081">This</a> proves an upper error bound on approximately block encoding a target matrix $A$ using UCR gates. It shows that for common matrices the error is well below the bound.</p>
</li>
</ol>
<p>We learn from (1.) that sparse angles can make QSD optimal through optimization. This hints towards a direct approach as a proof of concept. I apply the main result of (2.) to the UCR gates at each recursive step of QSD. The circuit for block encoding a real matrix $A$ is below. The proof starts by giving the error on the matrix oracle $O_A$ from thresholding rotation angles θˆ with cutoff δc,</p>
$$
δθ = θ ̃ − θ = ( Hˆ(⊗2n) P G ) δ θˆ ,
$$<p><img src="/block-encode2.png" alt="abc"></p>

    

  </article>

    </article>
  </main>
  <footer class="w-full">
    <p class="text-center text-sm p-4">
    Copyright 2025 Gigabug. All rights reserved.
</p>    

  </footer>
</body>
</html>