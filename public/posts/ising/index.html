<!doctype html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/js/all.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sugina-dev/latin-modern-web@1.0.1/style/latinmodern-mono.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<title>ising machine | Gigabug</title>
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.23/dist/full.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.tailwindcss.com?plugins=typography,aspect-ratio,line-clamp,container-queries"></script>
<script>
    tailwind.config = {
      daisyui: {
        themes: ["dim", "garden"]
      },
      darkMode: "selector"
    }
  </script>

      <script src="/js/main.js"></script>


</head>
<body class="bg-base-200 text-base-content">
  <header class="w-full">
    <div class="flex flex-col items-center pt-4 space-y-1">
    <a href="/">
        <img class="w-28 rounded-full" src="/headshot.png">
    </a>
    
  <nav>
    <ul class="flex justify-center space-x-3">
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/posts/">Posts</a>
    </li>
    </ul>
  </nav>

    <label class="swap swap-rotate">
        
        <input type="checkbox" class="theme-controller" value="light" />
        
        <svg
          class="swap-off h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" />
        </svg>
        
        <svg
          class="swap-on h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" />
        </svg>
      </label>
</div>

  </header>
  <main class="container min-h-screen px-8 mx-auto">
    <article class="prose dark:prose-invert max-w-prose mx-auto md:prose-lg">
      
<article class="prose dark:prose-invert">
    
    
    <h1>ising machine</h1>
    <time datetime="2024-10-31T20:04:35-04:00">October 31, 2024</time>
    <h1 id="overview">Overview</h1>
<p>Ising machines are novel analog computers designed to solve combinatorial optimization problems and have general machine learning applications. The Ising model is a mathematical model from statistical thermodynamics that doesn&rsquo;t describe a real physical system. However, as an abstract energy function, it becomes useful for constructing natural physics-based solvers. The energy function, known generally as the Hamiltonian, is
</p>
$$
H(s) = \frac{-s^{T}Js}{2}
$$<p>
where vector s is the discrete spin variables and matrix J is the interaction graph. Each spin variable can be +1 or -1 and $J(i,j)$ is the coupling strength between spin i and spin j. Finding the configuration of spins with the lowest energy is difficult. In fact, finding this configuration is equally difficult as problems that are NP-Hard. These kinds of problems span many applications from scheduling, logisitics, finance, etc.</p>
<p>The matrix representation of the combinatorial problem is mapped to the coupling strengths between the spins.</p>
<p>However, from statistical thermodynamics, we know the probability of a spin configuration at equilibirum follows the Boltzmann distribution</p>
$$
p_{i} = \frac{e^{-H(s_{i}) / k_{b} T}}{\sum_{} e^{-H(s_{j}) / k_b T}}
$$<p>The probability of each configutation is proportional to its energy. We hope to measure the high quality solutions more often.</p>
<p>The Ising machine is a device to realize a system that follow this distribution.</p>
<p>The problem is encoded on a physical network of coupled oscillators to leverage the natural convergence to an equilibrium state representing a solution. Many of the classically difficult combinatorial optimization problems (MaxCut, Subset Sum, etc.) can be encoded using a programmable coupling network. These types of problems are ubiquitous in practical applications such as finance, optimal logistics and scheduling, chip routing, and communication networks. As Moore’s Law nears its limits, these physics-based computers become an attractive potential for speed and power advantages over conventional algorithms run on traditional computers. Ising machines are an emerging area of research with fundamental open questions.</p>
<p>This post documents my development of such an Ising machine. I aim to open-source and ship a PCB that plugs into your laptop to solve general combinatorial problems using analog voltage signals. These signals model the spin variables s, and represent continuous probablistic bits. Lyapunov theory is applied to the generalized Kurumoto model to contruct an &ldquo;energy function&rdquo; for stability analysis of the network. A control input synchronizes the oscillations and induces locking to binarize the phases. An oscillator network has the natural tendency to minimize dissipated power by minimizing the amount of interactions.</p>
<p>These devices are natural physics-inspired solvers that operate at room-temperature and low power. While promising, their scale and programmability are limited. But they haven&rsquo;t been given enough attention. These machines are not used in practice because modern classic computing has been pushed so far. But as <a href="https://ieeexplore.ieee.org/document/7878935">Moore&rsquo;s law comes to an end</a> they come back to light.</p>
<p>The Kuramoto model can be formulated as a stochastic differential equation with a coupling and synchronization term. The simulated voltage phases converge to discrete values as the objective value (e.g., MaxCut) increases. Machine learning software frameworks can be built on this primitive. The coupled network evolves to the low-energy steady state.</p>
<p><img src="/kuramoto.png" alt=""></p>
<p><strong>Software</strong>
Development Tools</p>
<p>Macbook</p>
<ul>
<li>Research</li>
<li>MATLAB/C++</li>
<li>Arduino and IoT prototyping</li>
</ul>
<p>Windows machine</p>
<ul>
<li>Instrument control</li>
<li>Multisim/KiCAD for PCB design</li>
</ul>
<p>Linux Server</p>
<ul>
<li><code>diffrax</code>/<code>CUDA</code> for GPU simulations</li>
<li><code>thermox</code> to explore linear algebra primitives</li>
</ul>
<h1 id="references">References</h1>
<p>Notes on state-of-the-art</p>
<p>FPGA</p>
<ul>
<li>Purdue P
<ul>
<li>Trying to obtain MATLAB code</li>
</ul>
</li>
<li>DIMPLE
<ul>
<li>Runs on AWS</li>
<li>&ldquo;One important part I haven&rsquo;t thought about is how to write software to leverage this design&rdquo;</li>
</ul>
</li>
</ul>
<p><img src="/tech-for-ising-machines.png" alt="">
<img src="/phase-lock-devices.png" alt="">
<img src="/mohseniFig1.png" alt=""></p>
<ul>
<li>
<p>State of the art survey
<img src="/mohseniFig2.png" alt="">
<img src="/mohseniTable1.png" alt=""></p>
</li>
<li>
<p>MIT Lincoln Lab</p>
</li>
<li>
<p>4 fully-connected nodes with cross bar array of digital pots (AD5272)</p>
</li>
<li>
<p>coupling polarity controlled by output polarity of the differential summing amplifier(THS4140)</p>
</li>
<li>
<p>no feedback</p>
</li>
<li>
<p>get phases from a moving window Fourier transform on time-domain amplitude</p>
</li>
<li>
<p>time-to-solution scales with the oscillator frequency</p>
</li>
<li>
<p>&ldquo;We note that, unlike the simulation, no annealing of the coupling strength, is
required to arrive at the solution&rdquo;
<img src="/mit-breadboard-lc.png" alt=""></p>
</li>
<li>
<p>full adder using cross-coupled CMOS LC oscillators</p>
</li>
<li>
<p>transistor arrays (ALD1106/ALD1107), 10m inductors, 6.8nF capacitors for ~10kHz</p>
</li>
<li>
<p>SYNC input at 20kHz</p>
</li>
<li>
<p>fixed inductors and rotary potentiometers
<img src="/wangFig334.png" alt="">
<img src="/wangFig331.png" alt=""></p>
</li>
<li>
<p>8 grid-connected nodes</p>
</li>
<li>
<p>cross-coupled inverters (TI SN74HC04N), fixed 33μH inductors, trimmer capacitors (tuned ~30pF), 5V single supply</p>
</li>
<li>
<p>SYNC supplied to GND of inverter chips</p>
</li>
<li>
<p>manually plug in resistors and potentiometers for different problems</p>
</li>
<li>
<p>why are pots only used for diagonal edges?</p>
</li>
<li>
<p>fixed inductors and rotary potentiometers</p>
</li>
<li>
<p>read the oscillator phases using xor gates (TI SN74HC86N)</p>
</li>
<li>
<p>5MHz
<img src="/wangFig480.png" alt="">
<img src="/wangFig8.png" alt=""></p>
</li>
<li>
<p>32 Chimera-connected nodes</p>
</li>
<li>
<p>cross-coupled inverters (TI SN74HC04N), fixed inductors, trimmer capacitors, 5V single supply</p>
</li>
<li>
<p>rotary potentiometer for coupling; each one has male pin connectors to set polarity by shorting different pins</p>
</li>
<li>
<p>5MHz
<img src="/wangFig490.png" alt=""></p>
</li>
<li>
<p>64 grid-connected nodes; 4 per PCB</p>
</li>
<li>
<p>cross-coupled inverters (TI SN74HC04N), fixed inductors, trimmer capacitors, 5V single supply</p>
</li>
<li>
<p>digital potentiometer (AD5206) for coupling; each one uses one channel and single pole double throw on-off-on switch for polarity</p>
</li>
<li>
<p>192 couplings?</p>
</li>
<li>
<p>1MHz
<img src="/wangFig414.png" alt=""></p>
</li>
<li>
<p>240 nodes; 12 dense-connected per PCB with 1200 couplings</p>
</li>
<li>
<p>cross-coupled inverters (TI SN74HC04N), fixed inductors, trimmer capacitors, 5V single supply</p>
</li>
<li>
<p>digital potentiometer (AD5206) for coupling; uses wiper position to switch polarity and eliminate switches</p>
</li>
<li>
<p>motherboard edge connects 20 PCBs in 4-by-5 toroidal grid</p>
</li>
<li>
<p>1MHz</p>
</li>
<li>
<p>∼5W for all nodes and peripheral circuitry, excluding ony LEDs
<img src="/wangFig415.png" alt=""></p>
</li>
<li>
<p>Normal Computing (2023)</p>
</li>
<li>
<p>(weight diffuser) ↔ (diffusion process) ↔ (s-mode device)</p>
</li>
<li>
<p>(posterior drift network) ↔ (score network) ↔ (Maxwell’s demon device)</p>
</li>
<li>
<p>(auxiliary SDE) ↔ (s-mode device)</p>
</li>
<li>
<p>(optimization ODE) ↔ (latent variable evolution in Maxwell’s demon device)</p>
</li>
<li>
<p>analog or digital-analog score network architecture for less latency</p>
</li>
<li>
<p>Thought I saw a green chip at some point
<img src="/normal-chip-2023.png" alt="">
<img src="/normal-roadmap.png" alt="">
<img src="/normal-hardware.png" alt=""></p>
</li>
<li>
<p>simulates wave-digital system of equations (MATLAB)</p>
</li>
<li>
<p>bread boards are used with</p>
</li>
<li>
<p>&ldquo;we observe higher power dissipation, when SHIL is used. However, since anti-phase synchronization still minimizes power dissipation, we see that the oscilla- tors assume this states nonetheless. This phenomenon is very important and has not been pointed out in litera- ture so far.&rdquo;
<img src="/beattieFig17.png" alt="">
<img src="/beattieFig3.png" alt=""></p>
</li>
<li>
<p>1440 nodes with 11,724 couplings; 2584 are freely routable, rest are locally fixed</p>
</li>
<li>
<p>MATLAB for test management, OIM configuration, timing scheduling, and analysis</p>
</li>
<li>
<p>AMD Threadripper Pro 5965WX 24-core, 256GB RAM took ~4.67 hours per problem
<img src="/graberFig2c.png" alt="">
<img src="/graberFig4.png" alt="">
<img src="/graberTable1-2024.png" alt=""></p>
</li>
<li>
<p>0.878-approx for maxcut with log computation time scaling</p>
</li>
<li>
<p>OP-amp Schmidt trigger oscillator
<img src="/delacourTable1.png" alt="">
<img src="/delacourTable3.png" alt="">
<img src="/delacourFig5.png" alt=""></p>
</li>
<li>
<p>Scalable ring-oscillator-based integrated circuit
<img src="/moyTable1.png" alt="">
<img src="/moyFig2.png" alt=""></p>
</li>
<li>
<p>Proposed system is intended to provide a flexible experimental platform for further research of the internal mechanisms.
<img src="/graberTable1.png" alt="">
<img src="/graberFig8.png" alt=""></p>
</li>
<li>
<p>Proposes &ldquo;tanh-make-break&rdquo; annealing heuristic; incoming current at each node is related to its M and B</p>
</li>
<li>
<p>Allows multiple nodes to flip in parallel without synchronization</p>
</li>
<li>
<p>Supports cubic interactions
<img src="/sharmaFig3.png" alt=""></p>
</li>
<li>
<p>Uses intrinsic noise in memristor Hopfield neural network
<img src="/caiFig1.png" alt="">
<img src="/caiFig3.png" alt="">
<img src="/caiTable1.png" alt=""></p>
</li>
<li>
<p>Coupled ring oscillator (ROSC)-based scalable probabilistic Ising computer
<img src="/ahmedFig10.png" alt="">
<img src="/ahmedTable1.png" alt=""></p>
</li>
<li>
<p>Spin operator (processing local memory) which provides coefficients with
expandable bit width and fast parallel spin updates according to the Gibbs distribution</p>
</li>
<li>
<p>Low-latency inter-chip interface connecting two Ising chips
<img src="/takemotoFig267.png" alt="">
<img src="/takemotoFig467.png" alt=""></p>
</li>
</ul>

    

  </article>

    </article>
  </main>
  <footer class="w-full">
    <p class="text-center text-sm p-4">
    Copyright 2025 Gigabug. All rights reserved.
</p>    

  </footer>
</body>
</html>