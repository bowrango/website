<!doctype html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/js/all.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sugina-dev/latin-modern-web@1.0.1/style/latinmodern-mono.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<title>clash royale | Gigabug</title>
<link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.23/dist/full.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.tailwindcss.com?plugins=typography,aspect-ratio,line-clamp,container-queries"></script>
<script>
    tailwind.config = {
      daisyui: {
        themes: ["dim", "garden"]
      },
      darkMode: "selector"
    }
  </script>

      <script src="/js/main.js"></script>


</head>
<body class="bg-base-200 text-base-content">
  <header class="w-full">
    <div class="flex flex-col items-center pt-4 space-y-1">
    <a href="/">
        <img class="w-28 rounded-full" src="/headshot.png">
    </a>
    
  <nav>
    <ul class="flex justify-center space-x-3">
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/posts/">Posts</a>
    </li>
    </ul>
  </nav>

    <label class="swap swap-rotate">
        
        <input type="checkbox" class="theme-controller" value="light" />
        
        <svg
          class="swap-off h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" />
        </svg>
        
        <svg
          class="swap-on h-8 w-8 fill-current"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24">
          <path
            d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" />
        </svg>
      </label>
</div>

  </header>
  <main class="container min-h-screen px-8 mx-auto">
    <article class="prose dark:prose-invert max-w-prose mx-auto md:prose-lg">
      
<article class="prose dark:prose-invert">
    
    
    <h1>clash royale</h1>
    <time datetime="2024-09-10T00:15:22-04:00">September 10, 2024</time>
    <p>Data analysis project from 2020 on the Clash Royale mobile game.</p>
<p>Card decks used by the top players in the world are scraped from the official Clash Royale API. Each card is a node, and together form deck graphs that model strategy. Deck observations can be clustered by attribute (e.g. troops, buildings, spells, etc.). The original code used node2vec as feature embedding, but I was also exploring conditional probability networks and graph attention for edge prediction. The goal was to provide utilities for time-series graph analysis of player trends. The project is deprecated but I dream of reviving it.</p>
<h1 id="code">Code</h1>
<p>Wrapper on <code>networkx</code> for querying the Clash Royale API. You&rsquo;ll need to <a href="https://developer.clashroyale.com/#/register">create an account</a> to get a token. Edges are undirected and weighted by how many times two cards are used together.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#00f">from</span> <span style="color:#000">RoyaleAPI</span> <span style="color:#00f">import</span> <span style="color:#000">Client</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> <span style="color:#000">matplotlib.pyplot</span> <span style="color:#00f">as</span> <span style="color:#000">plt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">with</span> <span style="color:#000">open</span>(<span style="color:#5a2">&#39;RoyaleAPI/key.txt&#39;</span>, <span style="color:#5a2">&#39;r&#39;</span>) <span style="color:#00f">as</span> <span style="color:#000">file</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#000">dev_key</span> = <span style="color:#000">file</span>.<span style="color:#000">read</span>().<span style="color:#000">replace</span>(<span style="color:#5a2">&#39;</span><span style="color:#5a2">\n</span><span style="color:#5a2">&#39;</span>, <span style="color:#5a2">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#000">proxy_url</span> = <span style="color:#5a2">&#39;https://proxy.royaleapi.dev/v1&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888;font-style:italic"># Sample decks used by the top 10 players in global</span>
</span></span><span style="display:flex;"><span><span style="color:#000">client</span> = <span style="color:#000">Client</span>(<span style="color:#000">token</span>=<span style="color:#000">dev_key</span>, <span style="color:#000">url</span>=<span style="color:#000">proxy_url</span>)
</span></span><span style="display:flex;"><span><span style="color:#000">graph</span> = <span style="color:#000">client</span>.<span style="color:#000">create_empty_graph</span>()
</span></span><span style="display:flex;"><span><span style="color:#000">top10_graph</span> = <span style="color:#000">client</span>.<span style="color:#000">build_graph</span>(<span style="color:#000">graph</span>, <span style="color:#000">depth</span>=<span style="color:#3af">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">nx</span>.<span style="color:#000">draw_circular</span>(<span style="color:#000">top_graph</span>, <span style="color:#000">with_labels</span>=<span style="color:#00f">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#000">plt</span>.<span style="color:#000">show</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/cards.png" alt=""></p>
<p>Probabilities are more informative. The normalized attribute matrix has rows that sum to 1. It says that for all edges (u,v), the element A(i,j) is the P(v=types[j] | u=types[i]). Diagonal elements are the probability of the same type being used in a deck. Buildings were only used with other buildings in about 4.4% of decks sampled, a not so popular strategy.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#000">client</span> = <span style="color:#000">Client</span>(<span style="color:#000">token</span>=<span style="color:#000">dev_key</span>, <span style="color:#000">url</span>=<span style="color:#000">proxy_url</span>)
</span></span><span style="display:flex;"><span><span style="color:#000">graph</span> = <span style="color:#000">client</span>.<span style="color:#000">create_empty_graph</span>()
</span></span><span style="display:flex;"><span><span style="color:#000">top_graph</span> = <span style="color:#000">client</span>.<span style="color:#000">build_graph</span>(<span style="color:#000">graph</span>, <span style="color:#000">depth</span>=<span style="color:#3af">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">types</span> = [<span style="color:#5a2">&#39;Troop&#39;</span>, <span style="color:#5a2">&#39;Spell&#39;</span>, <span style="color:#5a2">&#39;Building&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#000">probs</span> = <span style="color:#000">nx</span>.<span style="color:#000">attr_matrix</span>(<span style="color:#000">top_graph</span>, <span style="color:#000">node_attr</span>=<span style="color:#5a2">&#34;type&#34;</span>, <span style="color:#000">edge_attr</span>=<span style="color:#5a2">&#39;usages&#39;</span>, <span style="color:#000">normalized</span>=<span style="color:#00f">True</span>, <span style="color:#000">rc_order</span>=<span style="color:#000">types</span>)
</span></span><span style="display:flex;"><span><span style="color:#000">print</span>(<span style="color:#000">probs</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><pre tabindex="0"><code>[[0.45658263 0.41936775 0.12404962]
 [0.78915663 0.10692771 0.10391566]
 [0.66098081 0.29424307 0.04477612]]
</code></pre><p>This image shows how many times each card was used in decks from the top 500 players. There are clear usage hierarchies with an exponential looking dropoff. The game was so fun and I really wanted to learn trends over time. I should revisit this.</p>
<p><img src="/deg500.png" alt=""></p>
<h1 id="disclaimer">Disclaimer</h1>
<p>This content is not affiliated with, endorsed, sponsored, or specifically approved by Supercell and Supercell is not responsible for it. For more information see Supercell’s Fan Content Policy: <a href="https://www.supercell.com/fan-content-policy">www.supercell.com/fan-content-policy</a>.</p>

    

  </article>

    </article>
  </main>
  <footer class="w-full">
    <p class="text-center text-sm p-4">
    Copyright 2025 Gigabug. All rights reserved.
</p>    

  </footer>
</body>
</html>